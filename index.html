<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#00d2ff">
    <meta name="description" content="NinePacman.ID - Verified Identity Generator System">
    <title>NinePacman.ID - Verified System</title>
    
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIk5pbmVQYWNtYW4uSUQgUHJlbWl1bSIsCiAgInNob3J0X25hbWUiOiAiTmluZVBhY21hbiIsCiAgInN0YXJ0X3VybCI6ICIuL2luZGV4Lmh0bWwiLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiMwYTBhMGEiLAogICJ0aGVtZV9jb2xvciI6ICIjMDBkMmZmIiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAibG9nby5wbmciLAogICAgICAic2l6ZXMiOiAiMTkyeDE5MiIsCiAgICAgICJ0eXBlIjogImltYWdlL3BuZyIKICAgIH0KICBdCn0=">
    
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="apple-touch-icon" href="logo.png">
    
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        :root { 
            --primary: #00d2ff; 
            --dark: #0a0a0a; 
            --card: rgba(22, 22, 22, 0.9); 
            --text: #e0e0e0; 
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(rgba(0, 0, 0, 0.85), rgba(0, 0, 0, 0.85)), url('bg.png'); 
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            color: var(--text);
            margin: 0;
            padding: 10px;
            min-height: 100vh;
            overscroll-behavior-y: none;
        }

        .container { max-width: 750px; margin: auto; position: relative; z-index: 10; padding-bottom: 50px; }
        
        .card { 
            background: var(--card); 
            backdrop-filter: blur(10px);
            border-radius: 12px; 
            padding: 20px; 
            margin-bottom: 20px; 
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.8);
        }

        .tabs { display: flex; gap: 5px; margin-bottom: 20px; background: rgba(0,0,0,0.5); padding: 5px; border-radius: 8px; }
        .tab { flex: 1; padding: 12px; text-align: center; cursor: pointer; border-radius: 6px; font-weight: bold; font-size: 13px; transition: 0.3s; color: #888; }
        .tab.active { background: var(--primary); color: #000; }
        
        input, textarea { background: rgba(0,0,0,0.5); border: 1px solid #333; color: white; padding: 12px; border-radius: 6px; width: 100%; box-sizing: border-box; margin-bottom: 10px; outline: none; }
        input:focus { border-color: var(--primary); }
        
        button { background: var(--primary); color: #000; border: none; padding: 12px; border-radius: 6px; font-weight: bold; cursor: pointer; width: 100%; transition: 0.2s; text-transform: uppercase; letter-spacing: 1px; }
        button:hover { filter: brightness(1.2); }
        button:active { transform: scale(0.98); }
        
        .btn-outline { background: transparent; border: 1px solid var(--primary); color: var(--primary); margin-top: 10px; }
        .btn-red { background: #ff4444; color: #fff; margin-top: 10px; }

        .btn-method { background: #1e88e5; color: white; margin-bottom: 10px; padding: 15px; font-size: 14px; width: 100%; }
        .btn-method:hover { background: #1565c0; transform: translateY(-2px); }
        
        .hidden { display: none; }
        .result-box { background: rgba(0,0,0,0.8); padding: 15px; border-radius: 8px; border-left: 3px solid var(--primary); font-family: 'Courier New', monospace; white-space: pre-wrap; margin-top: 15px; font-size: 13px; color: #fff; line-height: 1.8; word-break: break-all; }
        
        table { width: 100%; border-collapse: collapse; font-size: 11px; margin-top: 10px; }
        th { background: rgba(255,255,255,0.05); padding: 10px; text-align: left; color: var(--primary); }
        td { padding: 10px; border-bottom: 1px solid #222; }
        
        .badge-role { padding: 2px 8px; border-radius: 4px; font-size: 10px; font-weight: 800; display: inline-block; }
        .switch-auth { text-align: center; margin-top: 10px; font-size: 12px; color: #888; cursor: pointer; }
        .switch-auth b { color: var(--primary); }
        .otp-loader { border: 3px solid #f3f3f3; border-top: 3px solid var(--primary); border-radius: 50%; width: 15px; height: 15px; animation: spin 1s linear infinite; display: inline-block; margin-right: 5px; vertical-align: middle; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="container">
    <div style="text-align: center; padding: 30px 0;">
        <h1 style="margin: 0; letter-spacing: 4px; font-size: 32px; color: #fff; text-shadow: 0 0 10px var(--primary);">N I N E P A C M A N . I D</h1>
        <p style="color: var(--primary); font-size: 10px; margin-top: 5px; font-weight: bold;">PREMIUM IDENTITY ENGINE</p>
    </div>

    <div id="method-panel" class="card">
        <h2 style="text-align: center; font-size: 20px; margin-bottom: 25px; color: #fff;">Pilih Metode Login</h2>
        <button class="btn-method" onclick="startAuth('username')">LOGIN USERNAME</button>
        <button class="btn-method" onclick="startAuth('email')">LOGIN EMAIL</button>
    </div>

    <div id="bc-container" class="card hidden" style="border: 1px solid var(--primary); background: rgba(0, 210, 255, 0.1);">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <b style="color: var(--primary); font-size: 12px;">üì¢ PENGUMUMAN ADMIN</b>
            <button onclick="closeBC()" style="width: auto; padding: 2px 8px; background: none; color: #fff; font-size: 10px;">TUTUP</button>
        </div>
        <p id="bc-text" style="margin: 10px 0 0 0; font-size: 13px; color: #fff;"></p>
    </div>

    <div id="auth-panel" class="card hidden">
        <h2 id="auth-title" style="color: var(--primary); margin-top: 0; font-size: 18px;">üîë LOGIN ACCESS</h2>
        
        <div id="login-fields">
            <input type="number" id="login-tele-id" placeholder="Masukkan ID Telegram">
            <input type="password" id="login-pass" placeholder="Masukkan Password">
        </div>

        <div id="otp-field" class="hidden">
            <div style="background: rgba(0,210,255,0.1); padding: 15px; border-radius: 8px; text-align: center; margin-bottom: 15px;">
                <p id="otp-status-text" style="font-size: 13px; margin: 0;"><span class="otp-loader"></span>Mengirim OTP ke Telegram anda...</p>
            </div>
            <input type="number" id="otp-input" placeholder="Masukkan 6 Digit OTP">
            <input type="password" id="reset-new-pass" class="hidden" placeholder="Buat Password Baru">
        </div>

        <button id="auth-btn" onclick="handleAuth()">LOGIN TO SYSTEM</button>
        
        <div class="switch-auth" id="switch-text" onclick="toggleAuthMode()">
            Belum punya akun? <b>DAFTAR DISINI</b>
        </div>
        <div class="switch-auth" id="reset-link" onclick="toggleResetMode()" style="margin-top: 5px;">
            Lupa password? <b style="color: #ff4444;">RESET DISINI</b>
        </div>
        <button class="btn-outline" onclick="location.reload()" style="width: 100%; margin-top: 15px;">KEMBALI KE PILIHAN</button>
    </div>

    <div id="main-content" class="hidden">
        <div class="tabs">
            <div class="tab active" id="t-user" onclick="switchTab('user')">GENERATOR</div>
            <div class="tab" id="t-admin" onclick="switchTab('admin')">ADMIN PANEL</div>
        </div>

        <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div id="profile-icon" style="font-size: 28px; background: rgba(0,0,0,0.5); padding: 12px; border-radius: 50%; border: 1px solid #333;">üë§</div>
                    <div>
                        <h2 style="margin: 0; font-size: 16px; color: #fff;">User Profile</h2>
                        <div id="user-display" style="font-family: monospace; font-size: 14px; margin-top: 2px;"></div>
                        <div id="role-label" style="margin-top: 5px;"></div>
                    </div>
                </div>
                <button onclick="logout()" style="width: auto; padding: 6px 15px; font-size: 10px; background: rgba(255,0,0,0.1); color: #ff4444; border: 1px solid #600;">LOGOUT</button>
            </div>
            <hr style="border: 0; border-top: 1px solid #333; margin: 20px 0;">
            <div id="status-info" style="font-size: 18px; font-weight: 900; letter-spacing: 1px;"></div>
            <div id="u-timer" style="color: var(--primary); font-family: monospace; font-size: 13px; margin-top: 5px;"></div>
            
            <div id="claim-area" class="hidden" style="margin-top: 20px; border-top: 1px dashed #333; padding-top: 15px;">
                <input type="text" id="v-code" placeholder="MASUKKAN KODE VOUCHER">
                <button onclick="processClaim()">AKTIVASI PREMIUM</button>
            </div>
        </div>

        <div id="panel-user">
            <div class="card" id="gen-card" style="opacity: 0.2; pointer-events: none; transition: 0.3s;">
                <h2 style="color: var(--primary);">üåç IDENTITY GENERATOR</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px;">
                    <button onclick="generate('DE')">üá©üá™ GERMANY</button>
                    <button onclick="generate('FR')">üá´üá∑ FRANCE</button>
                    <button onclick="generate('NL')">üá≥üá± NETHERLANDS</button>
                    <button onclick="generate('GB')">üá¨üáß UK</button>
                </div>
                <div id="res-area" class="result-box hidden"></div>
            </div>
        </div>

        <div id="panel-admin" class="hidden">
            <div class="card">
                <h2 style="color: var(--primary);">üì¢ BROADCAST & BOT CONFIG</h2>
                <textarea id="bc-input" placeholder="Tulis pengumuman..." rows="2"></textarea>
                <button onclick="sendBC()">KIRIM BROADCAST (WEB + TELE)</button>
            </div>

            <div class="card">
                <h2 style="color: var(--primary);">üéüÔ∏è VOUCHER MAKER</h2>
                <div style="display: flex; gap: 10px;">
                    <input type="number" id="a-days" value="30" style="flex:1;">
                    <input type="number" id="a-qty" value="5" style="flex:1;">
                </div>
                <button onclick="adminCreate()">GENERATE VOUCHERS</button>
            </div>

            <div class="card">
                <h2 style="color: var(--primary);">üë• REGISTERED USERS</h2>
                <div style="max-height: 200px; overflow-y: auto; background: #000; border-radius: 8px;">
                    <table id="user-table-el">
                        <thead><tr><th>TELE ID</th><th>STATUS</th><th>ACTION</th></tr></thead>
                        <tbody id="user-list"></tbody>
                    </table>
                </div>
                <button class="btn-red" onclick="resetAll()">üóëÔ∏è RESET ALL DATABASE</button>
            </div>
            
            <div class="card">
                <h2 style="color: var(--primary);">üéüÔ∏è ACTIVE VOUCHERS</h2>
                <div style="max-height: 200px; overflow-y: auto; background: #000; border-radius: 8px;">
                    <table>
                        <thead><tr><th>CODE</th><th>DAY</th><th>STAT</th><th>USED</th></tr></thead>
                        <tbody id="voc-table"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const ADMIN_ID = "7815361814";
    const BOT_TOKEN = "8375119611:AAEKGow9IaZqGdDTBMewwYkL3wYMjXMKR18";
    
    const COUNTRY_CFG = {
        'GB': { name: 'United Kingdom', nat: 'gb', bank: 'MIDL', code: '1611', len: 8 },
        'FR': { name: 'France', nat: 'fr', bank: '20041', code: '1527', len: 11 },
        'DE': { name: 'Germany', nat: 'de', bank: '70051540', code: '1314', len: 10 },
        'NL': { name: 'Netherlands', nat: 'nl', bank: 'ABNA', code: '2321', len: 10 }
    };

    const getDB = (k) => JSON.parse(localStorage.getItem(k) || '{}');
    const setDB = (k, v) => localStorage.setItem(k, JSON.stringify(v));
    let timerInterval = null, authMode = 'login', currentOTP = null, tempId = null, tempPass = null, isResetMode = false;

    // Service Worker Registration for PWA
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('./service.js')
                .then(reg => console.log('ServiceWorker registered'))
                .catch(err => console.log('ServiceWorker failed: ', err));
        });
    }

    function startAuth(method) {
        document.getElementById('method-panel').classList.add('hidden');
        document.getElementById('auth-panel').classList.remove('hidden');
        document.getElementById('auth-title').innerText = `üîë LOGIN ${method.toUpperCase()}`;
    }

    function toggleAuthMode() {
        isResetMode = false;
        authMode = authMode === 'login' ? 'signup' : 'login';
        document.getElementById('auth-title').innerText = authMode === 'login' ? 'üîë LOGIN ACCESS' : 'üìù SIGN UP';
        document.getElementById('auth-btn').innerText = authMode === 'login' ? 'LOGIN TO SYSTEM' : 'KIRIM OTP KE TELEGRAM';
        document.getElementById('switch-text').innerHTML = authMode === 'login' ? 'Belum punya akun? <b>DAFTAR DISINI</b>' : 'Sudah punya akun? <b>LOGIN DISINI</b>';
        document.getElementById('otp-field').classList.add('hidden');
        document.getElementById('login-fields').classList.remove('hidden');
        document.getElementById('reset-new-pass').classList.add('hidden');
        document.getElementById('reset-link').classList.remove('hidden');
    }

    function toggleResetMode() {
        isResetMode = true;
        document.getElementById('auth-title').innerText = 'üîì RESET PASSWORD';
        document.getElementById('auth-btn').innerText = 'KIRIM OTP RESET';
        document.getElementById('switch-text').innerHTML = 'Kembali ke <b>LOGIN</b>';
        document.getElementById('reset-link').classList.add('hidden');
        document.getElementById('otp-field').classList.add('hidden');
        document.getElementById('login-fields').classList.remove('hidden');
        document.getElementById('login-pass').classList.add('hidden');
    }

    async function handleAuth() {
        if (isResetMode) {
            if (currentOTP) {
                const input = document.getElementById('otp-input').value;
                const newPass = document.getElementById('reset-new-pass').value;
                if (input == currentOTP && newPass) {
                    const accounts = getDB('accounts');
                    if (accounts[tempId]) {
                        accounts[tempId].password = newPass;
                        setDB('accounts', accounts);
                        alert("Password Berhasil Diperbarui!");
                        location.reload();
                    } else { alert("ID tidak terdaftar!"); location.reload(); }
                } else { alert("OTP Salah atau Password Baru Kosong!"); }
            } else {
                tempId = document.getElementById('login-tele-id').value.toString();
                if (!tempId) return alert("Masukkan ID Telegram!");
                currentOTP = Math.floor(100000 + Math.random() * 900000);
                document.getElementById('otp-status-text').innerText = "Mengirim OTP Reset...";
                try {
                    await axios.post(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                        chat_id: tempId,
                        text: `üîì *NINEPACMAN.ID RESET PASSWORD*\n\nKode OTP Reset Anda: \`${currentOTP}\`\nJangan berikan kode ini kepada siapapun.`,
                        parse_mode: 'Markdown'
                    });
                    document.getElementById('login-fields').classList.add('hidden');
                    document.getElementById('otp-field').classList.remove('hidden');
                    document.getElementById('reset-new-pass').classList.remove('hidden');
                    document.getElementById('auth-btn').innerText = 'KONFIRMASI RESET';
                } catch (e) { alert("Gagal kirim OTP! Pastikan bot sudah distart."); }
            }
            return;
        }

        if (authMode === 'login') {
            const id = document.getElementById('login-tele-id').value.toString();
            const pass = document.getElementById('login-pass').value;
            const accounts = getDB('accounts');
            
            if (id === ADMIN_ID && pass === 'admin123') {
                localStorage.setItem('currentUserId', id);
                return showMain();
            }

            if (accounts[id] && accounts[id].password === pass) {
                localStorage.setItem('currentUserId', id);
                showMain();
            } else { alert("ID atau Password salah!"); }
        } else {
            if (currentOTP) {
                const input = document.getElementById('otp-input').value;
                if (input == currentOTP) {
                    const accounts = getDB('accounts');
                    accounts[tempId] = { password: tempPass, teleId: tempId, isPremium: false, expiry: 0 };
                    setDB('accounts', accounts);
                    alert("Pendaftaran Berhasil!");
                    toggleAuthMode();
                    currentOTP = null;
                } else { alert("OTP Salah!"); }
            } else {
                tempId = document.getElementById('login-tele-id').value.toString();
                tempPass = document.getElementById('login-pass').value;
                if (!tempId || !tempPass) return alert("Lengkapi ID dan Password!");
                currentOTP = Math.floor(100000 + Math.random() * 900000);
                try {
                    await axios.post(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                        chat_id: tempId,
                        text: `üîê *NINEPACMAN.ID VERIFICATION*\n\nKode OTP Anda: \`${currentOTP}\`\nJangan berikan kode ini kepada siapapun.`,
                        parse_mode: 'Markdown'
                    });
                    document.getElementById('login-fields').classList.add('hidden');
                    document.getElementById('otp-field').classList.remove('hidden');
                    document.getElementById('auth-btn').innerText = 'VERIFIKASI OTP';
                } catch (e) { alert("Gagal kirim OTP! Pastikan Anda sudah chat ke bot."); }
            }
        }
    }

    async function generate(cc) {
        const resBox = document.getElementById('res-area');
        resBox.classList.remove('hidden');
        resBox.style.display = "block";
        resBox.innerText = "‚è≥ Generating Verified Data...";
        try {
            const cfg = COUNTRY_CFG[cc];
            const api = await axios.get(`https://randomuser.me/api/?nat=${cfg.nat}`);
            const u = api.data.results[0];
            const iban = calcIBAN(cc);
            resBox.innerHTML = `‚úÖ <b>DATA GENERATED</b>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n<b>NEGARA</b> : ${cfg.name}\n<b>NAMA</b>   : ${u.name.first} ${u.name.last}\n<b>STREET</b> : ${u.location.street.name} ${u.location.street.number}\n<b>CITY</b>   : ${u.location.city}\n<b>STATE</b>  : ${u.location.state}\n<b>ZIP</b>    : ${u.location.postcode}\n<b>PHONE</b>  : ${u.phone}\n<b>IBAN</b>   : <span style="color:var(--primary)">${iban}</span>\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ`;
        } catch (e) { resBox.innerText = "‚ùå Network error or API limit!"; }
    }

    function calcIBAN(cc) {
        const cfg = COUNTRY_CFG[cc];
        const acc = Math.floor(Math.pow(10, cfg.len-1) + Math.random() * Math.pow(10, cfg.len-1) * 9).toString();
        let bban = (cc === 'GB') ? cfg.bank + "070093" + acc : (cc === 'FR') ? cfg.bank + "01005" + acc + "80" : cfg.bank + acc;
        let rawStr = bban + cfg.code + "00";
        let numericStr = rawStr.replace(/[A-Z]/g, char => (char.charCodeAt(0) - 55).toString());
        const mod = BigInt(numericStr) % 97n;
        const checkDigits = (98n - mod).toString().padStart(2, '0');
        return `${cc}${checkDigits}${bban}`;
    }

    function logout() { localStorage.removeItem('currentUserId'); location.reload(); }

    function showMain() {
        if (localStorage.getItem('currentUserId')) {
            document.getElementById('auth-panel').classList.add('hidden');
            document.getElementById('method-panel').classList.add('hidden');
            document.getElementById('main-content').classList.remove('hidden');
            syncStatus();
        }
    }

    function switchTab(t) {
        const userId = localStorage.getItem('currentUserId');
        if (t === 'admin' && userId !== ADMIN_ID) return alert("AKSES ADMIN DITOLAK!");
        document.getElementById('panel-user').classList.toggle('hidden', t !== 'user');
        document.getElementById('panel-admin').classList.toggle('hidden', t !== 'admin');
        document.getElementById('t-user').classList.toggle('active', t === 'user');
        document.getElementById('t-admin').classList.toggle('active', t === 'admin');
        if(t === 'admin') { renderVoc(); renderUsers(); }
    }

    function syncStatus() {
        const userId = localStorage.getItem('currentUserId');
        const accounts = getDB('accounts');
        const u = (userId === ADMIN_ID) ? { isPremium: true, expiry: 4102444800000 } : (accounts[userId] || { isPremium: false });
        const bc = localStorage.getItem('activeBC');

        document.getElementById('user-display').innerText = `ID: ${userId}`;
        document.getElementById('user-display').style.color = (userId === ADMIN_ID ? 'var(--primary)' : '#888');
        document.getElementById('role-label').innerHTML = `<span class="badge-role" style="background:${userId === ADMIN_ID ? 'var(--primary)' : '#333'}; color:${userId === ADMIN_ID ? '#000' : '#aaa'};">${userId === ADMIN_ID ? 'ADMIN MASTER' : 'MEMBER'}</span>`;
        document.getElementById('profile-icon').innerText = (userId === ADMIN_ID ? '‚ö°' : 'üë§');

        if (bc) { document.getElementById('bc-container').classList.remove('hidden'); document.getElementById('bc-text').innerText = bc; }
        
        clearInterval(timerInterval);
        if (u.isPremium && (userId === ADMIN_ID || Date.now() < u.expiry)) {
            document.getElementById('status-info').innerHTML = `STATUS: <span style="color:var(--primary)">PREMIUM ‚úÖ</span>`;
            document.getElementById('gen-card').style.opacity = "1";
            document.getElementById('gen-card').style.pointerEvents = "auto";
            document.getElementById('claim-area').classList.add('hidden');
            if(userId !== ADMIN_ID) startTimer(u.expiry);
            else document.getElementById('u-timer').innerText = "EXPIRED: LIFETIME";
        } else {
            document.getElementById('status-info').innerHTML = `STATUS: <span style="color:#ff4444">FREE ‚ùå</span>`;
            document.getElementById('u-timer').innerText = "";
            document.getElementById('gen-card').style.opacity = "0.2";
            document.getElementById('gen-card').style.pointerEvents = "none";
            document.getElementById('claim-area').classList.remove('hidden');
        }
    }

    function startTimer(exp) {
        const box = document.getElementById('u-timer');
        timerInterval = setInterval(() => {
            const diff = exp - Date.now();
            if(diff <= 0) { clearInterval(timerInterval); location.reload(); }
            const d = Math.floor(diff/864e5), h = Math.floor((diff%864e5)/36e5), m = Math.floor((diff%36e5)/6e4), s = Math.floor((diff%6e4)/1000);
            box.innerText = `EXPIRED IN: ${d}d ${h}h ${m}m ${s}s`;
        }, 1000);
    }

    async function sendBC() {
        const msg = document.getElementById('bc-input').value;
        const chatid = ADMIN_ID; 
        if (!msg) return alert("Pesan kosong!");
        localStorage.setItem('activeBC', msg);
        if (BOT_TOKEN && chatid) {
            try {
                await axios.post(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, { chat_id: chatid, text: `üì¢ *NINEPACMAN.ID ANNOUNCEMENT*\n\n${msg}`, parse_mode: 'Markdown' });
                alert("Broadcast Terkirim!");
            } catch (e) { alert("Gagal kirim ke Telegram!"); }
        } else alert("Terkirim ke Web!");
        syncStatus();
    }

    function closeBC() { document.getElementById('bc-container').classList.add('hidden'); }

    function adminCreate() {
        const d = document.getElementById('a-days').value, q = document.getElementById('a-qty').value, vocs = getDB('vouchers');
        for(let i=0; i<q; i++) vocs[`GENPAC-${Math.random().toString(36).substr(2,8).toUpperCase()}`] = { days: d, status: 'available', usedBy: '-' };
        setDB('vouchers', vocs); renderVoc(); alert("Voucher Generated!");
    }

    function renderVoc() {
        const vocs = getDB('vouchers'), body = document.getElementById('voc-table'); 
        if(body) {
            body.innerHTML = '';
            Object.keys(vocs).reverse().forEach(k => {
                body.innerHTML += `<tr><td>${k}</td><td>${vocs[k].days}d</td><td style="color:${vocs[k].status==='available'?'#28a745':'#ff4444'}">${vocs[k].status}</td><td>${vocs[k].usedBy}</td></tr>`;
            });
        }
    }

    function resetAll() {
        if(confirm("Yakin hapus semua database?")) {
            localStorage.clear();
            location.reload();
        }
    }

    function renderUsers() {
        const accs = getDB('accounts'), body = document.getElementById('user-list'); body.innerHTML = '';
        Object.keys(accs).forEach(id => {
            body.innerHTML += `<tr><td>${id}</td><td>${accs[id].isPremium?'PREM':'FREE'}</td><td><button onclick="delUser('${id}')" style="font-size:8px; padding:4px; background:red; color:white;">HAPUS</button></td></tr>`;
        });
    }

    function delUser(id) { const accs = getDB('accounts'); delete accs[id]; setDB('accounts', accs); renderUsers(); }

    function processClaim() {
        const userId = localStorage.getItem('currentUserId'), code = document.getElementById('v-code').value.trim().toUpperCase(), vocs = getDB('vouchers'), accs = getDB('accounts');
        if(vocs[code] && vocs[code].status === 'available') {
            vocs[code].status = 'used'; vocs[code].usedBy = userId;
            if(accs[userId]) {
                accs[userId].isPremium = true; 
                accs[userId].expiry = Date.now() + (parseInt(vocs[code].days)*864e5);
                setDB('accounts', accs);
            }
            setDB('vouchers', vocs); alert("PREMIUM AKTIF!"); syncStatus();
        } else alert("Voucher Salah/Sudah Dipakai!");
    }

    window.onload = showMain;
</script>
</body>
</html>